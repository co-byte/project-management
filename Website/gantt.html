<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PERT Gantt Chart</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    // Load Google Charts API
    google.charts.load('current', {'packages':['gantt']});

    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
      // Fetch the JSON data generated by your TypeScript script
      fetch('./schedule.json')
        .then(response => response.json())
        .then(data => {
          const chartData = new google.visualization.DataTable();
          chartData.addColumn('string', 'Task ID');
          chartData.addColumn('string', 'Task Name');
          chartData.addColumn('string', 'Resource');
          chartData.addColumn('date', 'Start Date');
          chartData.addColumn('date', 'End Date');
          chartData.addColumn('number', 'Duration');
          chartData.addColumn('number', 'Percent Complete');
          chartData.addColumn('string', 'Dependencies');
          
          data.forEach(task => {
            // Convert schedule data to chart-friendly format
            chartData.addRow([
              task.id,                            // Task ID
              task.activity,                      // Task Name
              '',                                  // Resource (Optional)
              new Date(2024, 0, task.start),       // Start Date (dummy start date)
              new Date(2024, 0, task.end),         // End Date (dummy start date)
              task.end - task.start,               // Duration (in days)
              100,                                 // Percent Complete
              task.dependencies.join(', ')        // Dependencies (Task IDs)
            ]);
          });

          // Create the chart
          const chart = new google.visualization.Gantt(document.getElementById('gantt_chart'));

          const newHeight = data.length * 42 + 100; 
          console.log(newHeight)
          // Draw the chart with the data
          chart.draw(chartData, {
            height: newHeight,
            width: '100%'
          });
        })
        .catch(error => console.error('Error loading the schedule data:', error));
    }
  </script>

  <style>
    body {
      font-family: Arial, sans-serif;
    }

    h1 {
      text-align: center;
    }

    #gantt_chart {
      width: 100%;
      margin: 20px auto;
      padding: 0;
    }

  </style>
</head>
<body>
  <h1>PERT Gantt Chart</h1>
  <div id="gantt_chart"></div>
</body>
</html>
